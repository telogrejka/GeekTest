@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section featured {
    <section class="featured">
        <div class="content-wrapper">
            <hgroup class="title">
                <h2 style="font-weight:600">@ViewBag.Title</h2>
                <p style="font-size:1.1em; font-weight:600; padding-left:5px">Осталось времени:
                    <text id="countdown"> </text>
                </p>
            </hgroup>
        </div>
    </section>
}

@* Скрипт для отсчета времени до завершения теста *@
<script>
    function startTimer(duration, display) {
        var timer = duration, minutes, seconds;
        setInterval(function () {
            minutes = parseInt(timer / 60, 10);
            seconds = parseInt(timer % 60, 10);

            minutes = minutes < 10 ? "0" + minutes : minutes;
            seconds = seconds < 10 ? "0" + seconds : seconds;

            display.textContent = minutes + ":" + seconds;

            if (--timer < 0) {
                timer = 0;
                location.href = '@Url.Action("Index", "Results")'
            }
        }, 1000);
    }
    var duration = @ViewBag.Duration

    window.onload = function () {
        var Minutes = 60 * duration,
            display = document.querySelector('#countdown');
        startTimer(Minutes, display);
    };
</script>

<html>
<head>

    <script type="text/javascript">
        var observe;
        if (window.attachEvent) {
            observe = function (element, event, handler) {
                element.attachEvent('on' + event, handler);
            };
        }
        else {
            observe = function (element, event, handler) {
                element.addEventListener(event, handler, false);
            };
        }
        function init() {
            var text = document.getElementById('text');
            function resize() {
                text.style.height = 'auto';
                text.style.height = text.scrollHeight + 'px';
            }
            /* 0-timeout to get the already changed text */
            function delayedResize() {
                window.setTimeout(resize, 0);
            }
            observe(text, 'change', resize);
            observe(text, 'cut', delayedResize);
            observe(text, 'paste', delayedResize);
            observe(text, 'drop', delayedResize);
            observe(text, 'keydown', delayedResize);

            text.focus();
            text.select();
            resize();
        }
    </script>

</head>
<body>
    <ol>
        @for (int i = 0; i < ViewBag.QuestionsList.Count; i++)
        {
            <li>
                <textarea id="text" class="questionText">
                    @ViewBag.QuestionsList[@i]
                </textarea>
                <script>init();</script>
                <ul style="padding-left:20px">
                    @for (int j = 0; j < ViewBag.AnswerList[i].Count; j++)
                    {
                        <li>
                            <input style="width:15px" type="radio" name="@ViewBag.QuestionsList[i]"
                                   value=@ViewBag.AnswerList[i][j]> @ViewBag.AnswerList[i][j]
                            </li>
                    }
                </ul>
            </li>
        }
    </ol>

    <input type="button" value="Закончить тест"
           onclick="location.href='@Url.Action("Index", "Results", new { index = ViewBag.Index }, null)'" />
</body>
</html>